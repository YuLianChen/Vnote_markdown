# 自动亮度调节
## 步骤
1. 滤波算法
2. 滞后控制
3. 非线性映射
4. 平滑调节
## 一 滤波算法
* 原理：新的输出值是上一次的输出值与当前采样值的加权平均。公式为：Sₜ = α * Yₜ + (1-α) * Sₜ₋₁。其中 Sₜ 是当前平滑值，Yₜ 是当前采样值，Sₜ₋₁ 是上一次平滑值，α 是平滑因子（0 < α < 1）。

* 优点：无需存储历史数据队列，只用一个变量即可实现。计算量极小。通过调整α，可以灵活地在“响应速度”和“平滑度”之间权衡（α越大，响应越快，但越不平滑）。

* 缺点：同样存在响应延迟。

```c
/**
 * @brief 对新的光照度读数进行平滑处理
 * 
 * @param new_reading 新的光照度读数
 * @return float 平滑后的光照度值
 */
float alc_smoothed_value(float new_reading)
{
    static float smoothed_value = initial_value;
    const float alpha = 0.1f; // 平滑因子，取值范围为0到1

    smoothed_value = alpha * new_reading + (1 - alpha) * smoothed_value;

    return smoothed_value;
}
```

## 二 滞后阈值控制
